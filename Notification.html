<!DOCTYPE html>
<html class="light" lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Notification Center - Nav &amp; No Recent Activity</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;700&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }

    .material-symbols-outlined.fill {
      font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
    }
  </style>
  <script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#0d7ff2",
            "background-light": "#f5f7f8",
            "background-dark": "#101922",
          },
          fontFamily: {
            "display": ["Public Sans", "sans-serif"]
          },
          borderRadius: {
            "DEFAULT": "0.25rem",
            "lg": "0.5rem",
            "xl": "0.75rem",
            "full": "9999px"
          },
        },
      },
    }
  </script>
  <style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
  <style>
    body {
      min-height: max(884px, 100dvh);
    }
  </style>
</head>

<body class="font-display bg-white">
  <div class="relative mx-auto flex h-auto min-h-screen w-full max-w-md flex-col bg-white group/design-root"
    style='font-family: "Public Sans", "Noto Sans", sans-serif;'>
    <div class="sticky top-0 z-10 flex h-14 items-center bg-white p-4">
      <button class="flex size-8 items-center justify-center rounded-full" onclick="history.back()">
        <span class="material-symbols-outlined notranslate text-2xl text-gray-800">arrow_back_ios_new</span>
      </button>
      <h1 class="flex-1 text-center text-lg font-bold text-[#111418]">Notifications</h1>
      <div class="size-8"></div>
    </div>
    <main class="flex-1 overflow-y-auto px-4 pb-24">
      <!-- Completed Approvals Section -->
      <div id="completedApprovalsSection" class="hidden">
        <h2 class="pb-3 pt-4 text-lg font-bold text-gray-800">Completed Approvals</h2>
        <div id="completedApprovalsList" class="space-y-3">
          <!-- Completed approval notifications will be loaded here -->
        </div>
      </div>

      <div>
        <h2 class="pb-3 pt-4 text-lg font-bold text-gray-800">Suggested Applications for You</h2>
        <div class="space-y-3">
          <div class="rounded-lg border border-gray-200 bg-white p-4">
            <div class="flex items-start gap-4">
              <div class="mt-1 flex size-10 shrink-0 items-center justify-center rounded-full bg-blue-100 text-primary">
                <span class="material-symbols-outlined notranslate">school</span>
              </div>
              <div class="flex-1">
                <p class="font-semibold text-gray-900">New Scholarship Alert: Mara Youth Grant</p>
                <p class="mt-1 text-sm text-gray-600">Eligibility verified for your age and academic status.</p>
                <div class="mt-3">
                  <span class="inline-block rounded-full bg-blue-100 px-3 py-1 text-xs font-semibold text-primary">Apply
                    Now</span>
                </div>
              </div>
            </div>
          </div>
          <div class="rounded-lg border border-gray-200 bg-white p-4">
            <div class="flex items-start gap-4">
              <div
                class="mt-1 flex size-10 shrink-0 items-center justify-center rounded-full bg-green-100 text-green-600">
                <span class="material-symbols-outlined notranslate">work</span>
              </div>
              <div class="flex-1">
                <p class="font-semibold text-gray-900">SME Business Idea Match</p>
                <p class="mt-1 text-sm text-gray-600">Your profile suggests interest in Sole Proprietorship. Start
                  registration.</p>
                <div class="mt-3">
                  <span
                    class="inline-block rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-700">Recommended</span>
                </div>
              </div>
            </div>
          </div>
          <div id="dentalScheduleCard" class="rounded-lg border border-gray-200 bg-white p-4 hidden">
            <div class="flex items-start gap-4">
              <div
                class="mt-1 flex size-10 shrink-0 items-center justify-center rounded-full bg-green-100 text-green-600">
                <span class="material-symbols-outlined notranslate">event_available</span>
              </div>
              <div class="flex-1">
                <p class="font-semibold text-gray-900">Dental Appointment Scheduled</p>
                <p class="mt-1 text-sm text-gray-600">Your dental checkup has been approved. Appointment scheduled for
                  next week.</p>
                <div class="mt-3">
                  <span
                    class="inline-block rounded-full bg-green-100 px-3 py-1 text-xs font-semibold text-green-700">Confirmed</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        loadCompletedApprovals();
      });

      function loadCompletedApprovals() {
        const requests = JSON.parse(sessionStorage.getItem('child_requests') || '[]');
        const approvedRequests = requests.filter(r => r.status === 'approved');

        // Sort by timestamp descending (newest first) and reverse to show latest at top
        approvedRequests.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

        const section = document.getElementById('completedApprovalsSection');
        const list = document.getElementById('completedApprovalsList');

        // Check if dental clinic has approved the application
        const dentalClinicApproved = localStorage.getItem('dental_clinic_approved') === 'true';
        const dentalScheduleCard = document.getElementById('dentalScheduleCard');
        if (dentalScheduleCard) {
          if (dentalClinicApproved) {
            dentalScheduleCard.classList.remove('hidden');
          } else {
            dentalScheduleCard.classList.add('hidden');
          }
        }

        if (approvedRequests.length === 0) {
          section.classList.add('hidden');
          return;
        }

        section.classList.remove('hidden');
        list.innerHTML = approvedRequests.map(req => {
          // Get icon, color and redirect based on request type
          let icon = 'check_circle';
          let bgColor = 'bg-green-100';
          let textColor = 'text-green-600';
          let borderColor = 'border-green-200';
          let sectionBg = 'bg-green-50';
          let hoverBg = 'hover:bg-green-100';
          let redirectUrl = '#';
          let message = 'Your request has been approved.';

          switch (req.type) {
            case 'transaction':
              icon = 'stadia_controller';
              redirectUrl = 'Transaction_Summary.html';
              message = 'Your gaming purchase request has been approved by your guardian.';
              break;
            case 'scholarship':
              icon = 'school';
              bgColor = 'bg-blue-100';
              textColor = 'text-blue-600';
              borderColor = 'border-blue-200';
              sectionBg = 'bg-blue-50';
              hoverBg = 'hover:bg-blue-100';
              redirectUrl = 'scholarship_view_document.html';
              message = 'Your scholarship application has been approved.';
              break;
            case 'sme':
              icon = 'work';
              bgColor = 'bg-purple-100';
              textColor = 'text-purple-600';
              borderColor = 'border-purple-200';
              sectionBg = 'bg-purple-50';
              hoverBg = 'hover:bg-purple-100';
              redirectUrl = 'SME_view_document.html';
              message = 'Your SME application has been approved.';
              break;
            case 'dental':
              icon = 'health_and_safety';
              bgColor = 'bg-red-100';
              textColor = 'text-red-600';
              borderColor = 'border-red-200';
              sectionBg = 'bg-red-50';
              hoverBg = 'hover:bg-red-100';
              redirectUrl = 'Dental_Progress_Tracker.html';
              message = 'Your dental application has been approved.';
              break;
          }

          return `
          <div onclick="window.location.href='${redirectUrl}'" class="rounded-lg border ${borderColor} ${sectionBg} p-4 cursor-pointer ${hoverBg} transition-colors">
            <div class="flex items-start gap-4">
              <div class="mt-1 flex size-10 shrink-0 items-center justify-center rounded-full ${bgColor} ${textColor}">
                <span class="material-symbols-outlined notranslate">${icon}</span>
              </div>
              <div class="flex-1">
                <p class="font-semibold text-gray-900">${req.title}</p>
                <p class="mt-1 text-sm text-gray-600">${message}</p>
                <p class="mt-1 text-xs text-gray-500">${formatTime(req.timestamp)}</p>
                <div class="mt-3">
                  <span class="inline-block rounded-full bg-green-200 px-3 py-1 text-xs font-semibold text-green-700">Approved âœ“</span>
                </div>
              </div>
              <span class="material-symbols-outlined notranslate text-gray-400">chevron_right</span>
            </div>
          </div>
        `}).join('');
      }

      function formatTime(timestamp) {
        const date = new Date(timestamp);
        const now = new Date();
        const diffMs = now - date;
        const diffHours = Math.floor(diffMs / (1000 * 60 * 60));

        if (diffHours < 1) return 'Just now';
        if (diffHours < 24) return `${diffHours}h ago`;
        if (diffHours < 48) return 'Yesterday';
        return date.toLocaleDateString();
      }
    </script>

  </div>

  <script src="google_translate.js"></script>
</body>

</html>