<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Link Guardian - MyMULA Junior</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700;900&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#0054A6",
                        accent: "#4CA9FF",
                        "background-light": "#F7F9FC",
                        "background-dark": "#0f1923",
                    },
                    fontFamily: {
                        display: ["Public Sans", "sans-serif"],
                    },
                    borderRadius: {
                        lg: "12px",
                        xl: "16px",
                    },
                },
            },
        };
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: "FILL" 0, "wght" 400, "GRAD" 0, "opsz" 24;
        }

        body {
            min-height: 100vh;
        }

        .bounce-on-tap:active {
            transform: scale(0.98);
            transition: transform 0.1s;
        }
    </style>
</head>

<body class="font-display bg-background-light text-[#333333] dark:text-white dark:bg-background-dark">
    <div
        class="flex flex-col min-h-screen max-w-md mx-auto bg-white dark:bg-gray-900 shadow-md relative overflow-hidden">

        <!-- Header -->
        <div class="flex items-center p-4">
            <a href="mainpage_profile.html"
                class="p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
                <span class="material-symbols-outlined notranslate">arrow_back</span>
            </a>
            <h1 class="flex-1 text-center text-lg font-bold">Link Guardian</h1>
            <div class="w-10"></div> <!-- Spacer -->
        </div>

        <!-- Illustration Area -->
        <div class="flex justify-center mt-6 mb-4">
            <div class="relative w-48 h-48 rounded-full bg-orange-200 flex items-center justify-center overflow-hidden">
                <!-- Placeholder for the illustration from the image -->
                <span
                    class="material-symbols-outlined notranslate text-orange-400 text-9xl leading-none opacity-80">family_restroom</span>
            </div>
        </div>

        <div class="px-6 text-center mb-8">
            <h2 class="text-2xl font-bold mb-2">Let's connect to your Guardian</h2>
            <p class="text-gray-500 dark:text-gray-400">We need to link your account to your parent or guardian to keep
                you safe.</p>
        </div>

        <!-- Scan Option -->
        <div class="px-6 mb-6">
            <button onclick="startScan()"
                class="w-full bg-white dark:bg-gray-800 border-2 border-transparent hover:border-green-100 shadow-sm rounded-xl p-4 flex items-center justify-between group transition-all bounce-on-tap">
                <div class="flex items-center gap-4">
                    <div
                        class="w-10 h-10 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-500">
                        <span class="material-symbols-outlined notranslate">document_scanner</span>
                    </div>
                    <div class="text-left">
                        <p class="font-bold text-gray-900 dark:text-white">Scan Birth Certificate</p>
                        <p class="text-xs text-green-600 dark:text-green-400">Fastest way to link</p>
                    </div>
                </div>
                <span class="material-symbols-outlined notranslate text-gray-300 group-hover:text-green-500">chevron_right</span>
            </button>
        </div>

        <!-- Divider -->
        <div class="px-6 flex items-center gap-4 mb-6">
            <div class="h-[1px] flex-1 bg-gray-200 dark:bg-gray-700"></div>
            <p class="text-xs font-bold text-gray-400 uppercase tracking-wider">Or Enter Manually</p>
            <div class="h-[1px] flex-1 bg-gray-200 dark:bg-gray-700"></div>
        </div>

        <!-- Manual Input -->
        <div class="px-6 mb-8 flex-1">
            <label class="block text-sm font-bold mb-2 text-gray-900 dark:text-white">Guardian's IC Number</label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <span class="material-symbols-outlined notranslate text-gray-400">id_card</span>
                </div>
                <input type="text" id="icInput" placeholder="e.g. 800101-14-1234"
                    class="w-full pl-10 pr-4 py-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-all placeholder-gray-400 dark:placeholder-gray-600 text-gray-900 dark:text-white shadow-sm" />
            </div>
            <p class="text-xs text-gray-400 mt-2">Enter the 12-digit MyKad number.</p>
        </div>

        <!-- Bottom Action -->
        <div class="p-6 mt-auto">
            <button onclick="submitManual()"
                class="w-full bg-[#34D399] hover:bg-[#10B981] text-black font-bold py-4 rounded-full shadow-lg bounce-on-tap transition-colors">
                Continue
            </button>
            <div class="flex items-center justify-center gap-2 mt-4 text-gray-400">
                <span class="material-symbols-outlined notranslate text-xs">lock</span>
                <p class="text-xs">Your data is encrypted and secure.</p>
            </div>
        </div>

    </div>

    <!-- Scanning Modal Overlay (Hidden by default) -->
    <div id="scanOverlay" class="fixed inset-0 bg-black z-50 hidden flex-col">
        <div class="p-4 flex justify-end">
            <button onclick="closeScan()" class="text-white p-2"><span
                    class="material-symbols-outlined notranslate">close</span></button>
        </div>
        <div class="flex-1 flex flex-col items-center justify-center relative">
            <!-- Mock Camera View -->
            <div class="w-64 h-80 border-2 border-white/50 rounded-lg relative overflow-hidden">
                <div
                    class="absolute top-0 left-0 w-full h-1 bg-green-500 shadow-[0_0_15px_rgba(34,197,94,0.8)] animate-[scan_2s_infinite]">
                </div>
                <p class="text-white/70 text-center mt-32 px-4">Align Birth Certificate here</p>
            </div>
            <p class="text-white mt-8 font-medium animate-pulse" id="scanText">Scanning...</p>
        </div>
        <div class="p-8 bg-black/50 text-center">
            <button class="w-16 h-16 rounded-full border-4 border-white flex items-center justify-center"
                onclick="captureScan()">
                <div class="w-12 h-12 bg-white rounded-full"></div>
            </button>
        </div>
    </div>

    <style>
        @keyframes scan {
            0% {
                top: 0;
            }

            50% {
                top: 100%;
            }

            100% {
                top: 0;
            }
        }
    </style>

    <script>
        function startScan() {
            document.getElementById('scanOverlay').classList.remove('hidden');
            document.getElementById('scanOverlay').classList.add('flex');

            // Auto sim capture after 3s
            setTimeout(() => {
                if (!document.getElementById('scanOverlay').classList.contains('hidden')) {
                    captureScan();
                }
            }, 3000);
        }

        function closeScan() {
            document.getElementById('scanOverlay').classList.add('hidden');
            document.getElementById('scanOverlay').classList.remove('flex');
        }

        function captureScan() {
            const scanText = document.getElementById('scanText');
            scanText.innerText = "Analyzing...";
            scanText.classList.remove('animate-pulse');

            setTimeout(() => {
                closeScan();
                // Simulate reading value and setting pending status
                // The mock data should include the adult details as requested
                const mockGuardianData = {
                    child: "Ali Bin Abu",
                    guardian: "Abu Bakar",
                    ic: "850214-10-5566",
                    relation: "Father",
                    phone: "+6012-3456789"
                };

                sessionStorage.setItem('guardian_status', 'verified'); // Auto-verify: Simulating Government DB Match
                sessionStorage.setItem('guardian_data', JSON.stringify(mockGuardianData));

                // We also set the IC for consistency if used elsewhere
                document.getElementById('icInput').value = mockGuardianData.ic;

                // Create a brief verified feeling before redirecting
                alert("Birth Certificate Scanned! Guardian Verified against Government Database.");
                window.location.href = 'mainpage_profile.html';
            }, 1500);
        }

        function submitManual() {
            const ic = document.getElementById('icInput').value;
            if (ic.length < 12) {
                alert("Please enter a valid IC number");
                return;
            }
            // Simulate API call
            // Save state to sessionStorage to update profile page (resets on tab close)
            sessionStorage.setItem('guardian_status', 'waiting_verification');
            sessionStorage.setItem('guardian_ic', ic);

            // Redirect back to profile
            window.location.href = 'mainpage_profile.html';
        }
    </script>
  <script src="google_translate.js"></script>
</body>

</html>